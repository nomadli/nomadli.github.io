---
layout:         post
title:          ios知识点
subtitle:       ios知识点
date:           2015-12-04 09:08:00
author:         nomadli
header-img:     ../img/bg-coffee.jpeg
catalog:        true
tags:
        - IOS
---

* content
{:toc}

## 客服
1. https://developer.apple.com/support/D-U-N-S/cn/
2. nomadli studio
3. Room 0713, 840 Qinzhou Road, Xuhui District, Shanghai.
1. Shanghai
2. Shanghai
3. 200233
4. dzym79@gmail.com
5. 请求ID是：102122-648680
6. 20000027563488
7. -------
8. Xingyu intelligence
9. 102122-653765

## UIAppearance
1. 统一更换样式

## NetworkExtension
1. 连接VPN
2. 代理
3. 网络设置密码、权限验证
4. 流量监控
5. NEHotspotHelper

## ATS 
01. ATS (App Transport Security)  
02. NSAppTransportSecurity NSAllowsArbitraryLoads NSExceptionDomains
03. netname NSExceptionAllowsInsecureHTTPLoads true
04. NSAppTransportSecurity NSAllowsArbitraryLoads true
05. NSAppTransportSecurity AppTransportSecurity  allow Arbitary Loads true
06. NSAppTransportSecurity NSAllowsArbitraryLoadsInWebContent true

## 跳转到设置
01. [[UIApplication sharedApplication] openURL:];
02. wifi @"prefs:root=WIFI"
03. gps @"prefs:root=LOCATION_SERVICES"
04. faceTime @"prefs:root=FACETIME"
05. music @"prefs:root=MUSIC"
06. 墙纸 @"prefs:root=Wallpaper"
07. 蓝牙 @"prefs:root=Bluetooth"
08. icloud @"prefs:root=CASTLE"

17. \_\_attribute\_\_((aligned(8))) //字节对其
18. \_\_attribute\_\_((\_\_packed\_\_)) //紧密排列
19. \_\_attribute\_\_((\_\_transparent_union\_\_)) //可以实现动态类型参数,即将传入参数转为联合体

## lldb
01. watchpoint set expression (int*)&intvalue 监控地址
02. watchpoint set expression -w read -- address 读监控
03. watchpoint set expression -w read_write -- address 读写
04. watchpoint set expression -w write -- address 写
05. watchpoint delete num
06. watchpoint modify -c 表达式
07. pro hand -p true -s false SIGABRT/...  允许信号xcode不中断指定信号
08. breakpoint|br  br set -r . -s <PRODUCT_NAME> 在指定项目中正则设置断点
09. br set -n name 在指定名称上设置断点
10. br set -S alignLeftEdges: 指定参数名设置断点
11. br set -l num -f filename
12. br set -a mem_address
13. br set -F functionname
14. br set --func-regex 函数正则
15. br set --shlib xx.dylib --name funcname
16. br set --method|--name "-[xxx xxx]"
17. br set --selector xxx 第OC所有的函数上设置断点
18. br command add 断点序号
19. br set -F funcname 对导出函数设置断点
20. br xx -o condition
21. br xx -i ignone_times
22. br clear -l num -f filename
23. br l 显示所有断点
24. expression|expr  expr $r6=1 设置r6寄存器的值
25. expr $r6 显示r6寄存器值
26. expr xxx = xxx
27. backtrace|bt 打印调用栈
28. frame info 当前帧信息
29. frame select 0 选择栈帧
30. run|r 运行程序
31. process continue|c 继续执行
32. step|s 源码单步并进入
33. stepi|si 指令级别单步并进入
34. next|n 源码单步
35. nexti|ni 指令级单步
36. finish 运行到函数返回
37. return 直接从函数返回
38. thread list 打印线程
39. image list 显示所有库
41. image list -f -o 模块列表
42. image list -f -o xxx 查找SALR偏移
43. image lookup -a 查找原始地址信息
44. image lookup -r -n funcname 查找有调试符号的函数
45. image lookup -r -s funcname 查找无调试符号的函数
46. disassemble -a 地址  反汇编
47. disassemble -A thumbv4t|thumbv5|thumbv5e|thumbv6|thumbv6m|thumbv7|thumbv7f|thumbv7s|thumbv7k|thumbv7m|48umbv7em
49. memory read 起始地址 结束地址 | 寄存器 -outfile filepath --binary -force
50. memory write 寄存器| 地址  数据
51. x address 读取内存显示为字符串
52. register read/x|d 读寄存器显示为十六或十进制
53. register write r9 数据 写寄存器
54. display 表达式 每次单步执行后打印表达式的值
55. po [xx.button allTargets] 找按钮事件函数
```
(lldb) target create "xx/xx.app/Contents/MacOS/xxxx"
(lldb) set set $(target.run-args xx xx)
(lldb) run

ios
./debugserver *:1234 -a "YourAPPName" 附加进程
debugserver -x backboard *:1234 /Applications/MobileNotes.app/MobileNotes 直接启动进程

(lldb) platform select remote-ios
(lldb) process connect connect://localhost:1234

brew install usbmuxd
iproxy 2222 22 UUID
ssh –p 2222 root@127.0.0.1

image list -o -f 查看模块基地址
image lookup -r -n funcname  找偏移
br s -a 基地址+偏移
```

## LLVM
01. 源码->AST->LLVM IR->LLVM Bytecode->ASM->Native
02. x 按十六进制格式显示变量
03. d 按十进制格式显示变量
04. u 按十进制格式显示无符号整型
05. o 按八进制格式显示变量
06. t 按二进制格式显示变量
07. a 按十六进制格式显示变量
08. i 指令地址格式
09. c 按字符格式显示变量
10. f 按浮点数格式显示变量
11. b表示单字节
12. h表示双字节
13. w表示四字节
14. g表示八字节
15. expr 变量|表达式  显示变量或者表达式的值。
16. expr -f h --  变量|表达式 以16进制格式显示变量或表达式的内容
17. expr -f b --  变量|表达式 以二进制格式显示变量或者表达式的内容。
18. expr -o --  oc对象        等价于po  oc对象
19. expr -P  3 -- oc对象      上面命令的加强版本，他还会显示出对象内数据成员的结构，具体的P后面的数字就是你要想显示的层次。
20. expr my_struct->a = my_array[3]    //给my_struct的a成员赋值。
21. expr (char*)_cmd           //显示某个oc方法的方法名。
22. expr (IMP)[self methodForSelector:_cmd]    //执行某个方法调用.


## clan
01. clang -ccc-print-phases *.m 显示编译步骤  
02. clang -E *.c | less 只执行到预处理  
03. clang -Xclang -dump-tokens *.m 语法解析标记
04. clang -Xclang -ast-dump -fsyntax-only *.m 语法树 
05. clang -O3 -emit-llvm \*.c -c -o *.bc 二进制码 
06. llvm-dis < hello.bc | less 查看二进制码
07. clang -rewrite-objc *.m 转object 到 c 代码 

## bluetooth
01. CBCentralManager
02. CBPeripheral
03. CBCharacteristic
04. CBCentralManagerDelegate
05. CBPeripheralDelegate
06. CBPeripheralManager
07. CBMutableCharacteristic
08. CBPeripheralManagerDelegate

## Xcode 参数
01. ArgumentsPassedonLaunchd AppleLanguages 
    NSDoubleLocalizedStrings
    NSShowNonLocalizedStrings
    UIViewShowAlignmentRect
    -com.apple.CoreData.SQLDebug
    -com.apple.CoreData.SyntaxColoredLogging
    -com.apple.CoreData.MigrationDebug 
02. Environment Variables
    NSZombieEnabled
    NSDeallocateZombies
    MallocScribble
    MallocGuardEdges
    MallocStackLogging
    MallocStackLoggingNoCompact
    NSUnbufferedIO
    DYLD_PRINT_STATISTICSvalue 打印启动前耗时
03. /Library/LaunchAgents/***.plist
	 KeepAlive false
	 Lable xxx
	 ProgramArguments path/xx.sh
	 RunAtLoad true
	 UserName root
	 xx.sh :
	 RAMDISK_PATH="/Volumes/build-disk"
	 RAMDISK_SIZE=$((2048 * 512))
	 readonly RAMDISK_PATH
	 if [ ! -d $"RAMDISK_PATH" ]; then
	 	diskutil erasevolume HFS+ "${RAMDISK_PATH##*/}" (hdiutil attach -nomount ram://$RAMDISK_SIZE)
	else
		diskutil unmount "${RAMDISK_PATH##*/}"
	fi
04. 修改模板 Xcode.app/Contents/Developer/Library/Xcode/Templates/File Templates
05. \_\_\_FILEHEADER\_\_\_ 模板

        新建 IDETemplateMacros.plist
        key FILEHEADER
        内容第一行会自动添加//
        ___FULLUSERNAME___ ___DATE___ ___YEAR___ ___COPYRIGHT___ ___FILENAME___
        ___PACKAGENAME___ ___ORGANIZATIONNAME___ ___PRODUCTNAME___
        ___PROJECTNAME___ ___TARGETNAME___ ___TIME___ ___WORKSPACENAME___
        保存<ProjectName>.xcodeproj/xcuserdata/[username].xcuserdatad/ 当前工程
        保存<ProjectName>.xcodeproj/xcshareddata/ 当前工程所用人
        保存<WorkspaceName>.xcworkspace/xcuserdata/[username].xcuserdatad/当前项目
        保存<WorkspaceName>.xcworkspace/xcshareddata/ 当前项目所有人
        ~/Library/Developer/Xcode/UserData/ 所有项目所用人
    
## symbole
- [carsh符号单独介绍](./2016-01-04-crash log.md)
- 静态库与其它库使用了相同的静态库,但版本不一样
   - Symbols hidden by default  Yes 所有符号私有
   - Build Phases>Compile Sources>Compiler Flags 给需要导出符号的文件设置-fvisibility=default
   - 或者在函数及类前添加 __attribute__((visibility("default")))
   - Mach-O type选Relocatable Object File,将所有.o链接到一个.o进行符号隐藏
   - Stripped Linked Product Yes 会删除所有设置为私有的符号
- 代码级隐藏 __attribute__((visibility("hidden")))
- 文件级隐藏 -fvisibility=hidden

##  签名
01. security find-identity -v -p codesigning  列出所有可用证书
02. codesign -f -s 'iPhone Developer: name (number)' path.app 签名
03. codesign -vv -d path.app 查看签名信息
04. codesign --verify path.app 校验签名 如果正确无任何输出
05. codesign -d --entitlements - path.app 查看授权
06. security cms -D -i name.mobileprovision 查看配置文件信息
07. 服务器推送签名导出
    证书公私钥导出p12(公钥 cer、私钥 key)
    openssl x509 -in aps.cer -inform der -out public.pem
    openssl pkcs12 -nocerts -out private.pem -in private.p12
    openssl rsa -in private.pem -out private-noenc.pem 删除密码
    cat public.pem private.pem > apns-dev.pem 合并密钥
    
## Date
1. x	数字时区 +0800、+08:00 (x,xx,xxx,xxxx,xxxxx)
2. a	上下午 AM/PM
3. A   今天的第多少毫秒
4. c	本周第几天(c,cc,ccc,cccc)
5. d   本月第几天
6. e   本周第几天 (e,EEE,EEEE)
7. F   本月第几周
8. g   julian day (since 1/1/4713 BC)
9. G   era designator (G=GGG,GGGG)
10. h  hour (1-12, zero padded)
11. H  hour (0-23, zero padded)
12. L  month of year (L,LL,LLL,LLLL)
13. m  minute of hour (0-59, zero padded)
14. M  month of year (M,MM,MMM,MMMM)
15. Q  quarter of year (Q,QQ,QQQ,QQQQ) 季节
16. s  seconds of minute (0-59, zero padded)
17. S  fraction of second 毫秒
18. u  zero padded year 公元年
19. v  general timezone (v=vvv,vvvv)
20. w  week of year (0-53, zero padded)
21. y  year (y,yy,yyyy)
22. z  specific timezone (z=zzz,zzzz)
23. Z  timezone offset +0000

## Draw
01. shouldRasterize后,CALayer会被光栅化为bitmap并做为贴图进入GPU内存，动态变化的Layer不能用，否则。。。
02. CATiledLayer将图层再次分割成独立更新的小块在多个线程中为每个小块同时调用-drawLayer:inContext:方法。
03. drawsAsynchronously属性对传入-drawLayer:inContext:延缓绘制命令的执行，命令加入队列，在后台线程真正绘制。 

## gcc
001. -fprofile-arcs -ftest-coverage 代码覆盖率参数,检查代码是否无用

## simulator
01. 关机->cmd+r->开机->磁盘工具挂载主盘->控制台->mkdir /Volumes/Macintosh\ HD/AppleInternal

## 常用工具
- xcodebuild -list获取scheme、configration
- xcodebuild -project x.xcodeproj -scheme a -configuration Release CONFIGURATION_BUILD_DIR='~/Desktop/build/arm'
- xcrun -sdk iphoneos -v PackageApplication x.app -o x.ipa
- libtool -static -o 3.a 1.a 2.a
- ar -d lib.a conflict.o 删除
- arm neon 指令集
